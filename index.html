<!doctype html>
<html>

<head>
    <title>Dados sobre o Covid-19 no Brasil</title>
    <meta charset="utf-8">
    <script src="./utils/js/chart.js/Chart.min.js"></script>
    <script src="./utils/js/chart.js/utils.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <style>
        canvas {
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
        }

        .chart-container {
            width: 500px;
            margin-left: 40px;
            margin-right: 40px;
            margin-bottom: 40px;
        }

        .chart-container-main {
            width: 900px;
            margin-left: 40px;
            margin-right: 40px;
            margin-bottom: 40px;
        }

        .container {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: center;
        }
    </style>

    <style type="text/css">
        /* Chart.js */
        @keyframes chartjs-render-animation {
            from {
                opacity: .99
            }

            to {
                opacity: 1
            }
        }

        .chartjs-render-monitor {
            animation: chartjs-render-animation 1ms
        }

        .chartjs-size-monitor,
        .chartjs-size-monitor-expand,
        .chartjs-size-monitor-shrink {
            position: absolute;
            direction: ltr;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            pointer-events: none;
            visibility: hidden;
            z-index: -1
        }

        .chartjs-size-monitor-expand>div {
            position: absolute;
            width: 1000000px;
            height: 1000000px;
            left: 0;
            top: 0
        }

        .chartjs-size-monitor-shrink>div {
            position: absolute;
            width: 200%;
            height: 200%;
            left: 0;
            top: 0
        }
    </style>

</head>

<body>

    <div class="container">
        <h1>Número de casos</h1>
        <div class='row'>
            <div class='col chart-container-main '>
                <canvas id="canvas-days-since-fisrt-infection"></canvas>
            </div>
        </div>

        <div class="row text-center inline">
            <div class="col-12">
                <h2>Número de casos por país</h2>
            </div>
            <div class="col-12">
                <h6>O eixo y possui escala diferente em cada gráfico</h6>
            </div>
        </div>




    </div>

    <script>

        var data = (function () {
            var json = null;
            $.ajax({
                'async': false,
                'global': false,
                'url': "data/data.json",
                'dataType': "json",
                'success': function (data) {
                    json = data;
                }
            });
            return json;
        })();

        var config = {
            type: 'line',
            data: {
                labels: data['EUA'].days_since_first_infection,
                datasets: [{
                    label: 'Brasil',
                    backgroundColor: Samples.utils.transparentize(window.chartColors.red),
                    borderColor: window.chartColors.red,
                    fill: false,
                    data: data['Brasil'].confirmed,
                }, {
                    label: 'Alemanha',
                    ackgroundColor: Samples.utils.transparentize(window.chartColors.blue),
                    borderColor: window.chartColors.blue,
                    fill: false,
                    data: data['Alemanha'].confirmed,
                }, {
                    label: 'EUA',
                    ackgroundColor: Samples.utils.transparentize(window.chartColors.steel_blue),
                    borderColor: window.chartColors.steel_blue,
                    fill: false,
                    data: data['EUA'].confirmed,
                }, {
                    label: 'França',
                    ackgroundColor: Samples.utils.transparentize(window.chartColors.green),
                    borderColor: window.chartColors.green,
                    fill: false,
                    data: data['França'].confirmed,
                }, {
                    label: 'Portugal',
                    ackgroundColor: Samples.utils.transparentize(window.chartColors.yellow),
                    borderColor: window.chartColors.yellow,
                    fill: false,
                    data: data['Portugal'].confirmed,
                }, {
                    label: 'Itália',
                    ackgroundColor: Samples.utils.transparentize(window.chartColors.purple),
                    borderColor: window.chartColors.purple,
                    fill: false,
                    data: data['Itália'].confirmed,
                }, {
                    label: 'Espanha',
                    ackgroundColor: Samples.utils.transparentize(window.chartColors.orange),
                    borderColor: window.chartColors.orange,
                    fill: false,
                    data: data['Espanha'].confirmed,
                }]
            },
            options: {
                responsive: true,
                title: {
                    display: true,
                    text: 'Distribuição do número de casos a partir do primeiro caso reportado'
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Número de dias desde o primeiro caso reportado',
                            fontSize: 18,
                        },
                    }],
                    yAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Número oficial de casos (log)',
                            fontSize: 18,
                        },

                        type: 'logarithmic',

                        ticks: {
                            userCallback: function (tick) {
                                return tick.toLocaleString()
                            }, 
                            maxTicksLimit: 15,
                            //sampleSize: 15,
                        },
                    }]
                }
            }
        };




        function createConfig(country) {
            return {
                type: 'line',
                data: {
                    labels: data[country]['date'],
                    datasets: [{
                        label: 'Confirmados',
                        backgroundColor: window.chartColors.blue,
                        borderColor: window.chartColors.blue,
                        data: data[country]['confirmed'],
                        fill: false,
                    }, {
                        label: 'Recuperados',
                        fill: false,
                        backgroundColor: window.chartColors.green,
                        borderColor: window.chartColors.green,
                        data: data[country]['recovered'],
                    }, {
                        label: 'Mortes',
                        fill: false,
                        backgroundColor: window.chartColors.red,
                        borderColor: window.chartColors.red,
                        data: data[country]['deaths'],
                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: country
                    },
                    scales: {
                        xAxes: [{
                            gridLines: {
                                display: true,
                                drawBorder: true,
                                drawOnChartArea: true,
                                drawTicks: false,
                            }
                        }],
                        yAxes: [{
                            gridLines: {
                                display: true,
                                drawBorder: true,
                                drawOnChartArea: true,
                                drawTicks: false,
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Número oficial de casos',
                                fontSize: 14,
                            },
                            ticks: {
                                min: 0,
                                //stepSize: 10x
                            }
                        }],
                    }
                }
            };
        }

        window.onload = function () {
            var ctx = document.getElementById('canvas-days-since-fisrt-infection').getContext('2d');
            window.myLine = new Chart(ctx, config);
            var container = document.querySelector('.container');
            var row = document.createElement('div');
            row.classList.add('row');
            var c = 1;

            ['Brasil', 'China', 'EUA', 'Itália',
                'Espanha', 'Alemanha', 'França', 'Portugal'
            ].forEach(function (country) {
                col = document.createElement('div')
                col.classList.add('col');
                col.classList.add('chart-container');
                var canvas = document.createElement('canvas');
                col.appendChild(canvas);
                row.appendChild(col)
                var ctx = canvas.getContext('2d');
                var config = createConfig(country);
                new Chart(ctx, config);

                if (c % 2 == 0) {
                    container.appendChild(row)
                    row = document.createElement('div');
                    row.classList.add('row');
                }
                c += 1
            });
            container.appendChild(row)
        };

    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-161526158-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-161526158-1');
    </script>



</body>

<!-- Footer -->
<footer>
    <div class="row text-center inline">
        <div class="col-sm">
            Atualizado em 21 de março de 2020
        </div>
        <div class="w-100"></div>
        <div class="col-sm">
            <a href="https://github.com/johnnatan-messias/covid19/">GitHub</a>
        </div>
    </div>

</footer>
<!-- Footer -->

</html>